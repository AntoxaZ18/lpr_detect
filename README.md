# Описание
Этот проект направлен на детектирование номерных знаков автомобилей с использованием фреймворка YOLOv11,
а также проводит ablation study (анализ влияния различных компонентов модели).

# Содержание
- [Функции](#Функции)
- [Датасет](#Датасет)
- [Требования](#Требования)
- [Установка](#Установка)
- [Обучение](#Обучение)
- [Оценка](#Оценка)
- [Ablation Study](#Ablation-Study)
- [Экспорт ONNX](#Экспорт-ONNX)
- [Примечания](#Примечания)

# Функции
- Реализация YOLOv11 для детектирования номерных знаков
- Подготовка датасета
- Пайплайн обучения и оценки
- Ablation study для анализа влияния:
- Различных блоков бэкбона (например, CSPDarknet, ResNet)
- Различных функций потерь (NWD Loss)
- Экспорт в формат ONNX

# Датасет
В проекте используется [датасет](https://huggingface.co/datasets/AY000554/Car_plate_detecting_dataset) 

Car_plate_detecting_dataset - это набор данных из примерно 25,5К изображений российских автомобилей с номерами одного типа и разметки в формате YOLO: ```class x_center y_center width height```. Этот набор данных предназначен для обучения нейронных сетей обнаружению (локализации) номера автомобиля на изображении.
Основан на датасете [AUTO.RIA Numberplate Options Dataset](https://nomeroff.net.ua/datasets/autoriaNumberplateDataset-2023-03-06.zip) из проекта [Nomeroff Net](https://nomeroff.net.ua/#).

Данные разбиты на подвыборки для обучения, тестирования и валидации:

|Типп выборки данных | Количество изображений |
| :----------------: |:----------------------:|
| train |      20505 (80%)       |
| val   |       2563 (10%)       |
| test  |       2564 (10%)       |
| all images |         25632          |

В качестве разметки файлы .txt с именем изображения, внутри которых находится разметка в формате YOLO ```class x_center y_center width height```.

# Установка
1. Клонируйте репозиторий
   ```Powershell
   git clone https://github.com/AntoxaZ18/lpr_detect.git
   cd lpr_detect
   ```
2. Установите вирутальную среду и зависимости через Poetry
   Если хотите чтобы вирутальная среда создалась в папке с проектом
   ```Powershell
   poetry config settings.virtualenvs.in-project true
   ```
   Создайте преднастроенную виртуальную среду
   ```Powershell
   poetry install
   ```
   Активируйте среду при помощи poetry (опционально)
   ```Powershell
   poetry env activate
   ```
# Обучение

# Оценка

# Ablation Study

Результаты
Результаты ablation study хранятся в папке results/ и включают:

Конфигурацию моделей в виде yaml файлов
Обученную модель в формате torch и ONNX

Данные по характеристикам моделей

|       Модель       |       val map@50       |    val map@50-95   |       GFLOPS           |   FPS on CPU(onnx)     | 
| :----------------: |:----------------------:| :----------------: |:----------------------:|:----------------------:|
| original       |      0.986       |      0.822       |      6.5       |      27.9       |
| CSPA, C3k2 1   |      0.986       |      0.804       |      5.4       |      28.4       |
| CSPA->C3K2*    |      0.986       |      0.804       |      5.1       |      31.9       |
| SPFF->MAxPool  |      0.985       |      0.792       |      4.5       |      32.4       |
| Снижение разм  |      0.985       |      0.785       |      4.2       |      35.8       |
| C3K2->conv     |      0.985       |      0.769       |      4.0       |      38.7       |
| 320 NWD loss   |      0.966       |      0.742       |      4.0       |      80+        |




Оригинал модель nano
метрики (вал) 0.986 0.822

1 фаза уменьшены повторения в backbone c 2 до 1 yolo11_speed_1.yaml
метрики (вал) метрики (вал) 0.986 0.804

2 фаза замена тяжелого блока с2spa на c3k2 уменьшение количевтва каналов 1024->768 и 512->384 на внутренних слоях 5,5 GFLOPS 2,020,667 parameters, 2,020,651 gradients, 5.6 GFLOPs
метрики (вал) метрики (вал) 0.986 0.804  папка сspa_to_c3k2

3 фаза SPFF->Maxpool 1,927,931 parameters, 1,927,915 gradients, 5.5 GFLOPs
метрики 0,985 0,792

4 фаза еще более легкие внутренние слои 768->512 256->192 384->256 1,563,783 gradients, 4.6 GFLOPs
0.985      0.785

5 фаза 
c3k2->conv слои  1,233,683 parameters, 1,233,667 gradients, 4.1 GFLOPs
0.985      0.769

6 фаза 0,966 0,742 1,233,683 4,0 gflops
320*320
91 layers, 1,229,363 parameters, 0 gradients, 4.0 GFLOPs
0.966      0.742


320*320 nwdloss
0.966      0.74

# Экспорт в ONNX


# Примечания
Датасет, используемый в этом проекте, является пользовательским и должен быть подготовлен соответствующим образом.
Вы можете изменить data/your_dataset.yaml, чтобы адаптировать его под вашу структуру датасета.
Для более продвинутого использования обратитесь к документации YOLOv11 .
